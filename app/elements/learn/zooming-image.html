<dom-module id="zooming-image">
  <style>
  ::content #zooming-image {
    position: relative;
  };

  ::content #zooming-image-tag {
    position: absolute;
    top: 0;
    left: 0;
    width: 313px;
    height: 200px;
    z-index: 10;
  };

  ::content #fullsize {
    display: none;
    position: absolute;
    top: 0;
    left: 0;
    width: 0px;
    height: 0px;
    z-index: 20;
  };

  ::content #fullsize.zoomed {
      display: inline;
      width: auto;
      height: auto;
      animation: to-full-size 1s cubic-bezier(0.39, 0.58, 0.57, 1)  running;
      --webkit-animation: to-full-size 1s cubic-bezier(0.39, 0.58, 0.57, 1)  running;
  }


  /* Chrome, Safari, Opera */ 
  @-webkit-keyframes to-full-size {
      25% {width: 25%; height: 25%;}
      50% {width: 50%; height: 50%;}
      75% {width: 75%; height: 75%;}
      100% {width: 100%; height: 100%;}
  } 

  /* Standard syntax */ 
  @keyframes to-full-size {
      25% {width: 25%; height: 25%;}
      50% {width: 50%; height: 50%;}
      75% {width: 75%; height: 75%;}
      100% {width: 100%; height: 100%;}
  }

  /* Chrome, Safari, Opera */ 
  @-webkit-keyframes to-small-size {
      from {width: auto; height: auto;}
      to {width: 313px; height: 200px;}
  } 

  /* Standard syntax */ 
  @keyframes to-small-size {
      from {width: auto; height: auto;}
      to {width: 313px; height: 200px;}
  }

  </style>
  <template>
    <div id="zooming-image">
      <img id='thumbnail' src="{{ src }}">
      <img id='fullsize'>
      <paper-icon-button icon="zoom-in" on-click="showFullSized" style="position:absolute;z-index:11;right:0;bottom:0; color: white"></paper-icon-button>
    </div>
  </template>
</dom-module>
<script>
  Polymer({
    is: 'zooming-image',
    listeners: {
      "keyup": "zoomOutOnEsc",
      "click": "clickListener"
    },
    clickListener: function(e) {
      if (e.target.id == 'thumbnail') {
        this.showFullSized();
      }
    },
    showFullSized: function() {
      var zoomed = (this.id == 'fullsize') ? this : this.$['fullsize'];
      if (zoomed.src) {
        zoomed.classList.add('zoomed');
      } else {
        zoomed.onload = this.showFullSized;
        zoomed.addEventListener('click',this.hideFullSized);
        zoomed.addEventListener('keyup', this.zoomOutOnEsc);
        zoomed.src = this.fullSrc;
      }
    },
    hideFullSized: function() {
      var zoomed = (this.id == 'fullsize') ? this : this.$['fullsize'];
      zoomed.classList.remove('zoomed');
    },
    zoomOutOnEsc: function(e) { // doesn't work if it has lost focus, which is not obvious to users...
      if (e.keyCode == 27) {
        this.hideFullSized();
      }
    },
    properties: {
      src: {
          type: String,
          value: ""
      },
      fullSrc: {
          type: String,
          value: ""
      }
    }
  });
</script>
